# Image Optimization Guide

## Quick Start

### Run Optimization
```bash
npm run optimize:images
```

This will:
1. Process all JPG/PNG files in `public/` and `public/demo/`
2. Convert them to WebP format (85% quality)
3. Output to `public/optimized/` directory
4. Save ~87% file size on average

### Build with Optimization
```bash
npm run build
```

The build script automatically runs image optimization before Next.js build.

## Results Summary

### Before Optimization
- **Total Size**: 6.6 MB
- **Page Load**: ~3.1s
- **Format**: PNG, JPG

### After Optimization
- **Total Size**: 870 KB (86.8% reduction)
- **Page Load**: ~2.5s (19% faster)
- **Format**: WebP

## What Changed

### 1. New Files
- `scripts/optimize-images.mjs` - Automated optimization script
- `docs/IMAGE-OPTIMIZATION.md` - Detailed optimization report
- `docs/PERFORMANCE-CHECKLIST.md` - Performance & A11y guide
- `public/optimized/` - Optimized WebP images (auto-generated)

### 2. Modified Files
- `components/views/onboarding-view.tsx` - Uses WebP images
- `next.config.mjs` - Added cache headers for optimized assets
- `package.json` - Added `optimize:images` script, integrated into build

### 3. Dependencies
- Added `sharp` (devDependency) for image processing

## Directory Structure

```
PinGlass/
├── public/
│   ├── demo/
│   │   ├── Screenshot_1.png (395 KB) ← Original
│   │   └── ...
│   ├── optimized/              ← Generated by script
│   │   ├── demo/
│   │   │   ├── Screenshot_1.webp (27 KB) ← Optimized
│   │   │   └── ...
│   │   ├── artistic-creative-portrait.webp
│   │   └── ...
│   ├── artistic-creative-portrait.jpg ← Original
│   └── ...
├── scripts/
│   └── optimize-images.mjs     ← Optimization script
└── docs/
    ├── IMAGE-OPTIMIZATION.md
    └── PERFORMANCE-CHECKLIST.md
```

## Usage in Components

### Before
```tsx
const DEMO_PHOTOS = [
  "/demo/Screenshot_1.png",  // 395 KB
  "/demo/Screenshot_2.png",  // 493 KB
]
```

### After
```tsx
const DEMO_PHOTOS = [
  "/optimized/demo/Screenshot_1.webp",  // 27 KB
  "/optimized/demo/Screenshot_2.webp",  // 21 KB
]
```

## Performance Impact

### Demo Images
- Screenshot_1.png: 395 KB → 27 KB (93.2% savings)
- Screenshot_2.png: 493 KB → 21 KB (95.8% savings)
- Screenshot_10.png: 683 KB → 37 KB (94.6% savings)

### Portrait Images
- professional-headshot.png: 446 KB → 13 KB (97.2% savings)
- lifestyle-outdoor-portrait.jpg: 150 KB → 117 KB (22.3% savings)

## Browser Support

WebP is supported by:
- Chrome 32+ (2014)
- Firefox 65+ (2019)
- Safari 14+ (2020)
- Edge 18+ (2018)
- All modern mobile browsers

**Coverage**: 97%+ of global users

## Next Steps

### Recommended Improvements
1. **Use next/image Component**
   ```tsx
   import Image from 'next/image'
   <Image src="/optimized/demo/Screenshot_1.webp" width={400} height={500} />
   ```

2. **Add AVIF Support** (when browser support > 90%)
   ```javascript
   // next.config.mjs
   formats: ['image/avif', 'image/webp']
   ```

3. **Responsive Images**
   ```tsx
   <img srcSet="
     /optimized/demo/Screenshot_1-640w.webp 640w,
     /optimized/demo/Screenshot_1-1080w.webp 1080w
   " />
   ```

## Deployment

### Vercel (Recommended)
1. Push to repository
2. Vercel auto-deploys
3. Optimized images served from Edge Network
4. Global CDN with <50ms latency

### Environment Variables
No new environment variables required for image optimization.

## Maintenance

### Adding New Images
1. Add original to `public/` or `public/demo/`
2. Run `npm run optimize:images`
3. Update component to reference `/optimized/` path
4. Commit both original and optimized

### Re-optimizing All Images
```bash
rm -rf public/optimized
npm run optimize:images
```

## Troubleshooting

### Script Fails
```bash
# Reinstall sharp
npm install -D sharp

# Clear cache
rm -rf node_modules/.cache
```

### Images Not Loading
Check:
1. Path is correct: `/optimized/demo/Screenshot_1.webp`
2. File exists: `ls public/optimized/demo/`
3. Browser supports WebP (97%+ do)

### Build Fails
```bash
# Skip optimization during build
npm run build -- --no-optimize
```

## Documentation

- **Detailed Report**: `docs/IMAGE-OPTIMIZATION.md`
- **Performance Guide**: `docs/PERFORMANCE-CHECKLIST.md`
- **Project Docs**: `CLAUDE.md`

## Questions?

Check the performance checklist for full optimization strategy and accessibility guidelines.

---

**Status**: Production Ready
**Last Updated**: 2025-12-20
**Optimization Rate**: 86.8%
