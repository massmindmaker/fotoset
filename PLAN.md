# ĞŸĞ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸: ZIP ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ, Telegram Ğ±Ğ¾Ñ‚, ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ UI

## ĞĞ±Ğ·Ğ¾Ñ€

Ğ ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞµĞ¼ Ñ‚Ñ€Ğ¸ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ Ğ´Ğ¾ÑÑ‚Ğ°Ğ²ĞºĞ¸ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ„Ğ¾Ñ‚Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼:

1. **ZIP ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ** â€” ĞºĞ½Ğ¾Ğ¿ĞºĞ° "Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²ÑÑ‘" Ğ´Ğ»Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ²ÑĞµÑ… Ñ„Ğ¾Ñ‚Ğ¾ Ğ¾Ğ´Ğ½Ğ¸Ğ¼ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ¾Ğ¼
2. **Telegram Ğ±Ğ¾Ñ‚** â€” Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ„Ğ¾Ñ‚Ğ¾ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ² Telegram Ñ‡Ğ°Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
3. **Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ UI** â€” ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ ÑˆĞµÑ€Ğ¸Ğ½Ğ³Ğ°, Ğ³Ğ°Ğ»ĞµÑ€ĞµÑ Ñ swipe, Ğ»Ğ°Ğ¹Ñ‚Ğ±Ğ¾ĞºÑ

---

## 1. ZIP Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ResultsView    â”‚â”€â”€â”€â”€â–¶â”‚  JSZip (client) â”‚â”€â”€â”€â”€â–¶â”‚  .zip Ñ„Ğ°Ğ¹Ğ»   â”‚
â”‚  "Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²ÑÑ‘"   â”‚     â”‚  + FileSaver    â”‚     â”‚  Ğ½Ğ° Ğ´Ğ¸ÑĞº     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸĞ¾Ğ´Ñ…Ğ¾Ğ´: ĞšĞ»Ğ¸ĞµĞ½Ñ‚ÑĞºĞ°Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ĞºĞ»Ğ¸ĞµĞ½Ñ‚, Ğ° Ğ½Ğµ ÑĞµÑ€Ğ²ĞµÑ€:**
- ĞĞµÑ‚ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€
- Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ»ÑĞ±Ñ‹Ğ¼Ğ¸ URL (Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğµ Ñ…Ğ¾ÑÑ‚Ğ¸Ğ½Ğ³Ğ¸)
- Ğ‘Ñ‹ÑÑ‚Ñ€ĞµĞµ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- ĞĞµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ ÑĞµÑ€Ğ²ĞµÑ€Ğ½Ğ¾Ğ³Ğ¾ storage

**Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸:**
```bash
npm install jszip file-saver
npm install -D @types/file-saver
```

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

#### 1.1 Ğ£Ñ‚Ğ¸Ğ»Ğ¸Ñ‚Ğ° `lib/download-zip.ts`
```typescript
import JSZip from 'jszip'
import { saveAs } from 'file-saver'

interface DownloadProgress {
  current: number
  total: number
  percentage: number
}

export async function downloadPhotosAsZip(
  urls: string[],
  filename: string = 'pinglass-photos.zip',
  onProgress?: (progress: DownloadProgress) => void
): Promise<void> {
  const zip = new JSZip()
  const folder = zip.folder('photos')

  let completed = 0

  // Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ²ÑĞµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾ (Ñ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸ĞµĞ¼)
  const batchSize = 5
  for (let i = 0; i < urls.length; i += batchSize) {
    const batch = urls.slice(i, i + batchSize)

    await Promise.all(batch.map(async (url, idx) => {
      try {
        const response = await fetch(url)
        const blob = await response.blob()
        const extension = blob.type.split('/')[1] || 'jpg'
        folder?.file(`photo-${i + idx + 1}.${extension}`, blob)
      } catch (error) {
        console.error(`Failed to fetch ${url}:`, error)
      }

      completed++
      onProgress?.({
        current: completed,
        total: urls.length,
        percentage: Math.round((completed / urls.length) * 100)
      })
    }))
  }

  // Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµĞ¼ ZIP
  const content = await zip.generateAsync({
    type: 'blob',
    compression: 'DEFLATE',
    compressionOptions: { level: 6 }
  })

  // Ğ¡ĞºĞ°Ñ‡Ğ¸Ğ²Ğ°ĞµĞ¼
  saveAs(content, filename)
}
```

#### 1.2 ĞšĞ½Ğ¾Ğ¿ĞºĞ° Ğ² ResultsView
```tsx
const [isDownloading, setIsDownloading] = useState(false)
const [downloadProgress, setDownloadProgress] = useState(0)

const handleDownloadAll = async () => {
  setIsDownloading(true)
  try {
    await downloadPhotosAsZip(
      assets.map(a => a.url),
      `${persona.name}-pinglass.zip`,
      (progress) => setDownloadProgress(progress.percentage)
    )
  } finally {
    setIsDownloading(false)
    setDownloadProgress(0)
  }
}

// Ğ’ JSX:
<button onClick={handleDownloadAll} disabled={isDownloading}>
  {isDownloading ? (
    <>Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° {downloadProgress}%</>
  ) : (
    <>Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ²ÑĞµ ({assets.length})</>
  )}
</button>
```

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

| Ğ¤Ğ°Ğ¹Ğ» | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ |
|------|----------|
| `lib/download-zip.ts` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» |
| `components/persona-app.tsx` | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ Ğ² ResultsView |
| `package.json` | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ jszip, file-saver |

---

## 2. Telegram Ğ‘Ğ¾Ñ‚

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend    â”‚     â”‚  API Route   â”‚     â”‚ Telegram Bot â”‚
â”‚ "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ   â”‚â”€â”€â”€â”€â–¶â”‚ /api/telegramâ”‚â”€â”€â”€â”€â–¶â”‚    API      â”‚
â”‚ Ğ² Telegram"  â”‚     â”‚  /send       â”‚     â”‚ sendMediaGrpâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                        â”‚
        â”‚                                        â–¼
        â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ t.me/PinGlassBot?start={session_id} â”‚
                     â”‚ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ /start         â”‚
                     â”‚ Ğ‘Ğ¾Ñ‚ ÑĞ²ÑĞ·Ñ‹Ğ²Ğ°ĞµÑ‚ chat_id Ñ session_id   â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸĞ¾Ğ´Ñ…Ğ¾Ğ´: Webhook + Deep Link

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾Ñ‚ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´:**
- ĞĞµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- ĞŸÑ€Ğ¾ÑÑ‚Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ
- Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ½Ğ° Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ñ…

### Flow

1. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² Telegram"
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ `session_id` Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ Ğ² Ğ‘Ğ” Ğ²Ğ¼ĞµÑÑ‚Ğµ Ñ URLs Ñ„Ğ¾Ñ‚Ğ¾
3. ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ ÑÑÑ‹Ğ»ĞºĞ° `t.me/PinGlassBot?start={session_id}`
4. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ Start Ğ² Ğ±Ğ¾Ñ‚Ğµ
5. Ğ‘Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ `session_id` Ğ¸Ğ· ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ `/start`
6. Ğ‘Ğ¾Ñ‚ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ñ„Ğ¾Ñ‚Ğ¾ Ğ¿Ğ¾ `session_id` Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¸Ñ… Ğ² Ñ‡Ğ°Ñ‚

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

#### 2.1 ĞĞ¾Ğ²Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ² Ğ‘Ğ”
```sql
CREATE TABLE telegram_sessions (
  id SERIAL PRIMARY KEY,
  session_id VARCHAR(64) UNIQUE NOT NULL,
  chat_id BIGINT,  -- Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ ĞºĞ¾Ğ³Ğ´Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ°Ğ¶Ğ¼Ñ‘Ñ‚ Start
  photo_urls TEXT[] NOT NULL,
  status VARCHAR(20) DEFAULT 'pending',  -- pending, linked, sent, expired
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP DEFAULT (NOW() + INTERVAL '24 hours')
);
```

#### 2.2 API Routes

**`app/api/telegram/create-session/route.ts`**
```typescript
// POST: ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ ÑĞµÑÑĞ¸Ñ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ñ„Ğ¾Ñ‚Ğ¾
// Request: { urls: string[] }
// Response: { sessionId: string, botLink: string }
```

**`app/api/telegram/webhook/route.ts`**
```typescript
// POST: webhook Ğ¾Ñ‚ Telegram
// ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ /start {session_id}
// Ğ¡Ğ²ÑĞ·Ñ‹Ğ²Ğ°ĞµÑ‚ chat_id Ñ session_id
// ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ñ„Ğ¾Ñ‚Ğ¾ Ñ‡ĞµÑ€ĞµĞ· sendMediaGroup
```

#### 2.3 Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° Ğ±Ğ¾Ñ‚Ğ° `lib/telegram-bot.ts`
```typescript
import { Telegraf } from 'telegraf'

const bot = new Telegraf(process.env.TELEGRAM_BOT_TOKEN!)

export async function sendPhotosToChat(
  chatId: number,
  photoUrls: string[],
  caption?: string
): Promise<void> {
  // Telegram Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚ mediaGroup Ğ´Ğ¾ 10 Ñ„Ğ¾Ñ‚Ğ¾
  const chunks = chunkArray(photoUrls, 10)

  for (const chunk of chunks) {
    const media = chunk.map((url, i) => ({
      type: 'photo' as const,
      media: url,
      caption: i === 0 ? caption : undefined
    }))

    await bot.telegram.sendMediaGroup(chatId, media)
  }
}

export { bot }
```

### ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ±Ğ¾Ñ‚Ğ°

1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ñ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· @BotFather
2. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾ĞºĞµĞ½
3. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ webhook: `https://yourdomain.com/api/telegram/webhook`
4. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ `TELEGRAM_BOT_TOKEN` Ğ² env

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ/Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

| Ğ¤Ğ°Ğ¹Ğ» | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ |
|------|----------|
| `lib/telegram-bot.ts` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ |
| `app/api/telegram/create-session/route.ts` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ |
| `app/api/telegram/webhook/route.ts` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ |
| `components/persona-app.tsx` | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ |
| `package.json` | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ telegraf |

### ENV Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ
```env
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_WEBHOOK_SECRET=random_secret_string
```

---

## 3. Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ UI

### 3.1 ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½ ResultsView

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† ĞĞ°Ğ·Ğ°Ğ´                              [Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞµÑ‰Ñ‘]         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚                   Ğ“Ğ›ĞĞ’ĞĞĞ• Ğ¤ĞĞ¢Ğ                      â”‚    â”‚
â”‚  â”‚                   (Ñ swipe)                         â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  [<]                                           [>]  â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚                    1 / 23                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [â¬‡ï¸ ZIP] [ğŸ“± Telegram] [ğŸ”— ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ] [ğŸ“¤ ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ] â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”         â”‚
â”‚  â”‚    â”‚ â”‚    â”‚ â”‚    â”‚ â”‚    â”‚ â”‚    â”‚ â”‚    â”‚ â”‚    â”‚  ...    â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜         â”‚
â”‚  (Ğ¼Ğ¸Ğ½Ğ¸Ğ°Ñ‚ÑÑ€Ñ‹ Ñ Ğ³Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼ ÑĞºÑ€Ğ¾Ğ»Ğ»Ğ¾Ğ¼)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

#### ShareButtons ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚
```tsx
interface ShareButtonsProps {
  urls: string[]
  title: string
  onDownloadZip: () => void
  onSendTelegram: () => void
  isDownloading: boolean
}

const ShareButtons: React.FC<ShareButtonsProps> = ({...}) => (
  <div className="flex gap-2 flex-wrap">
    <button onClick={onDownloadZip}>
      <Archive /> Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ ZIP
    </button>
    <button onClick={onSendTelegram}>
      <Send /> Telegram
    </button>
    <button onClick={handleShare}>
      <Share2 /> ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ
    </button>
  </div>
)
```

#### PhotoGallery Ñ swipe
```tsx
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ CSS scroll-snap Ğ´Ğ»Ñ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ swipe
<div className="flex overflow-x-auto snap-x snap-mandatory">
  {photos.map(photo => (
    <div key={photo.id} className="snap-center shrink-0 w-full">
      <img src={photo.url} />
    </div>
  ))}
</div>
```

### 3.3 Web Share API (Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ ÑˆĞµÑ€Ğ¸Ğ½Ğ³)
```typescript
const handleNativeShare = async () => {
  if (navigator.share) {
    await navigator.share({
      title: 'ĞœĞ¾Ğ¸ AI-Ñ„Ğ¾Ñ‚Ğ¾ Ğ¾Ñ‚ PinGlass',
      text: 'Ğ¡Ğ¼Ğ¾Ñ‚Ñ€Ğ¸ ĞºĞ°ĞºĞ¸Ğµ Ñ„Ğ¾Ñ‚Ğ¾ Ñ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ»!',
      url: window.location.href
    })
  } else {
    // Fallback: ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ
    await navigator.clipboard.writeText(window.location.href)
    toast('Ğ¡ÑÑ‹Ğ»ĞºĞ° ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°!')
  }
}
```

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

| Ğ¤Ğ°Ğ¹Ğ» | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ |
|------|----------|
| `components/persona-app.tsx` | ĞŸĞµÑ€ĞµÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ ResultsView |
| `components/share-buttons.tsx` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ |
| `components/photo-gallery.tsx` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ Ğ³Ğ°Ğ»ĞµÑ€ĞµĞ¸ |

---

## ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### Ğ¤Ğ°Ğ·Ğ° 1: ZIP ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ (1-2 Ñ‡Ğ°ÑĞ°)
1. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ (jszip, file-saver)
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `lib/download-zip.ts`
3. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ² ResultsView
4. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ¤Ğ°Ğ·Ğ° 2: Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ UI (2-3 Ñ‡Ğ°ÑĞ°)
1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ShareButtons ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚
2. ĞŸĞµÑ€ĞµÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ ResultsView Ñ Ğ½Ğ¾Ğ²Ñ‹Ğ¼ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½Ğ¾Ğ¼
3. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ swipe Ğ³Ğ°Ğ»ĞµÑ€ĞµÑ
4. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Web Share API
5. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ¤Ğ°Ğ·Ğ° 3: Telegram Ğ±Ğ¾Ñ‚ (3-4 Ñ‡Ğ°ÑĞ°)
1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ñ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· @BotFather
2. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ telegraf
3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ telegram_sessions
4. Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ API routes
5. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ² UI
6. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ webhook Ğ½Ğ° production
7. Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

---

## Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ´Ğ»Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸

```bash
npm install jszip file-saver telegraf
npm install -D @types/file-saver
```

## ENV Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
TELEGRAM_WEBHOOK_SECRET=your_random_secret
```

## SQL Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ

```sql
-- Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ´Ğ»Ñ Telegram ÑĞµÑÑĞ¸Ğ¹
CREATE TABLE telegram_sessions (
  id SERIAL PRIMARY KEY,
  session_id VARCHAR(64) UNIQUE NOT NULL,
  chat_id BIGINT,
  photo_urls TEXT[] NOT NULL,
  status VARCHAR(20) DEFAULT 'pending',
  created_at TIMESTAMP DEFAULT NOW(),
  expires_at TIMESTAMP DEFAULT (NOW() + INTERVAL '24 hours')
);

-- Ğ˜Ğ½Ğ´ĞµĞºÑ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
CREATE INDEX idx_telegram_sessions_session_id ON telegram_sessions(session_id);
CREATE INDEX idx_telegram_sessions_expires ON telegram_sessions(expires_at);
```

---

## Ğ Ğ¸ÑĞºĞ¸ Ğ¸ Ğ¼Ğ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸

| Ğ Ğ¸ÑĞº | ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ |
|------|-----------|
| CORS Ğ¿Ñ€Ğ¸ ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ | Ğ˜Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ Ğ½Ğ°ÑˆĞ¸Ñ… Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ğ¾Ğ² (Kie.ai, fal.ai) Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ¸Ğ¼ĞµÑ‚ÑŒ CORS headers |
| Telegram rate limits | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ sendMediaGroup |
| Ğ‘Ğ¾Ğ»ÑŒÑˆĞ¸Ğµ ZIP Ñ„Ğ°Ğ¹Ğ»Ñ‹ | ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ ~50 Ñ„Ğ¾Ñ‚Ğ¾, Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ |
| Webhook Ğ½Ğµ Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ retry Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ, Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ |

---

## Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸?

ĞŸĞ¾ÑĞ»Ğµ ÑƒÑ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¿Ğ»Ğ°Ğ½Ğ°, Ğ½Ğ°Ñ‡Ğ½Ñƒ Ñ Ğ¤Ğ°Ğ·Ñ‹ 1 (ZIP ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ).
